---
title: "Group_project_clive's_work.Rmd"
author: "Clive Smith"
date: "2024-03-05"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


```{r}
library(tidyverse)
library(lubridate)
library(janitor)
```


```{r}
hospitals <- read_csv("data/healthcare_dataset.csv")
```

```{r}
hospitals <- clean_names(hospitals)
names(hospitals)
```
Here we removed the infromation that is not neeeded for the project. 
```{r}
hospitals <- hospitals %>%
  select(-blood_type, -room_number)
```

```{r}
hospitals_final <- hospitals %>%
  mutate(id = as.integer(factor(name))) %>%
  select(-doctor, -name) %>%
  arrange(id)
```

part 2
#create a new column with price categories.
#create a graph and list for 3 things: price by hospitals, prices by insurance companies, and prices by condition.

```{r}
hospitals_final %>% 
  select(billing_amount) %>% 
  summary()
```

```{r}
hospitals_final %>% 
mutate(price_level=case_when(billing_amount<13507 ~ "low", 
                                  billing_amount>=13507 & billing_amount<=25258 ~ "normal", 
                                  billing_amount>25258 & billing_amount<=37734 ~ "high", 
                                  billing_amount>37734 ~ "very high"))
```
#this graph isn't feasible, there are just too many hospitals. We need to find a way to cut down on the number shown here somehow.
```{r}
hospitals_final %>% 
mutate(price_level=case_when(billing_amount<13507 ~ "low", 
                                  billing_amount>=13507 & billing_amount<=25258 ~ "normal", 
                                  billing_amount>25258 & billing_amount<=37734 ~ "high", 
                                  billing_amount>37734 ~ "very high")) %>% 
  group_by(hospital) %>% 
  count(hospital, price_level) %>% 
  ggplot(aes(x=hospital, y=n, fill=price_level))+
  geom_col(position="dodge")
```
#note: we need to find a way to get the locations for these hospitals. Currently, we only have the names of the hospitals, which is quite problematic.

```{r}
hospitals_final %>% 
mutate(price_level=case_when(billing_amount<13507 ~ "low", 
                                  billing_amount>=13507 & billing_amount<=25258 ~ "normal", 
                                  billing_amount>25258 & billing_amount<=37734 ~ "high", 
                                  billing_amount>37734 ~ "very high")) %>% 
  count(insurance_provider, price_level) %>% 
  ggplot(aes(x=insurance_provider, y=n, fill=price_level))+
  geom_col(position="dodge")
```

```{r}
hospitals_final %>% 
mutate(price_level=case_when(billing_amount<13507 ~ "low", 
                                  billing_amount>=13507 & billing_amount<=25258 ~ "normal", 
                                  billing_amount>25258 & billing_amount<=37734 ~ "high", 
                                  billing_amount>37734 ~ "very high")) %>% 
  count(medical_condition, price_level) %>% 
  ggplot(aes(x=medical_condition, y=n, fill=price_level))+
  geom_col(position = "dodge")
```

